@using Inventory.MVC.Extensions
@using Inventory.MVC.Models
@using Kendo.Mvc.UI;

<script>
var crudHub = $.connection.crudHub;
    var hubStart = $.connection.hub.start();
</script>
@(
        Html.Kendo().Grid<ProductViewModel>()
            .AddBaseOptions()
            .Name("ProductViewModelGrid")
            .DataSource(dataSource => dataSource
                .SignalR()
                .AutoSync(false)
                .Events(events => events.Error("errorHandler")
                    .Push(@<text>
                               function(e) {
                               var notification = $("#notification").data("kendoNotification");
                               notification.success(e.type);
                               }
                           </text>))
                .PageSize(10)
                .Transport(tr => tr
                    .Promise("hubStart")
                        .Hub("crudHub")
                    .Client(c => c
                        .Read("read")
                        .Create("create")
                        .Update("update")
                        .Destroy("destroy"))
                    .Server(s => s
                        .Read("read")
                        .Create("create")
                        .Update("update")
                        .Destroy("destroy")))
                .Schema(schema => schema
                    .Model(model =>
                    {
                        model.Id(m => m.Id);
                        model.Field(m => m.Id).Editable(false);
                    })
                )
            )
      )
